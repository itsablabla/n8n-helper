/**
 * Example usage of @garza/n8n-helper
 * 
 * Shows how easy it is to create workflows programmatically
 */

const N8nHelper = require('./index');

// Initialize
const n8n = new N8nHelper({
  baseUrl: 'https://garza-n8n.fly.dev',
  apiKey: "your-api-key-here",
  silent: true  // No notifications during setup
});

async function examples() {
  console.log('🚀 n8n SDK Examples\n');

  // Example 1: Create a simple webhook
  console.log('Example 1: Simple webhook');
  const webhook = await n8n.createWebhook({
    name: 'Test Webhook',
    path: '/test-hook',
    silent: true
  });
  console.log('✅ Created:', webhook);
  console.log('   URL:', webhook.webhookUrl);
  console.log('   ID:', webhook.workflowId);
  console.log();

  // Example 2: Use a pre-built pattern
  console.log('Example 2: Claude → Beeper pattern');
  const pattern = await n8n.createPattern('webhook-claude-beeper', {
    name: 'AI Assistant',
    chatId: '!XlgdehhyJTXFVfIKZR:beeper.com',
    activate: true
  });
  console.log('✅ Created:', pattern);
  console.log();

  // Example 3: List all workflows
  console.log('Example 3: List workflows');
  const workflows = await n8n.listWorkflows();
  console.log(`✅ Found ${workflows.length} workflows`);
  workflows.slice(0, 3).forEach(w => {
    console.log(`   - ${w.name} (${w.active ? 'active' : 'inactive'})`);
  });
  console.log();

  // Example 4: Trigger a webhook
  console.log('Example 4: Trigger webhook');
  const result = await n8n.triggerWebhook('/test-hook', {
    message: 'Hello from SDK!',
    timestamp: new Date().toISOString()
  });
  console.log('✅ Triggered:', result);
  console.log();
}

// Run examples
if (require.main === module) {
  examples().catch(console.error);
}

module.exports = { examples };
